<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhangbin.dao.BlogMapper">

    <insert id="addBlog" parameterType="Blog">
        insert into blog(id, title, author,create_time, views) values (#{id}, #{title}, #{author}, #{createTime},#{views} )
    </insert>

    <!--SQLæ ‡ç­¾å°†å…¬å…±çš„æ¡ä»¶å­—æ®µæå–å‡ºæ¥ï¼Œå®šä¹‰å”¯ä¸?IDä¾›å…¶ä»–SQLä½¿ç”¨,åœ¨è¦ä½¿ç”¨SQLä¸­åŠ å…?<include>æ ‡ç­¾ä½¿ç”¨ refidå¯¹åº”çš„æ˜¯<SQL>çš„id-->
    <sql id="sql-title">
        <if test="title != null">
            and title = #{title}
        </if>
        <if test="author != null">
            and author = #{author}
        </if>
    </sql>

    <!--åŠ¨æ?æŸ¥è¯¢ä¹‹if-->
    <!--<where>æ ‡ç­¾æ›¿ä»£SQLä¸­çš„WHEREã€?
        where å…ƒç´ åªä¼šåœ¨å­å…ƒç´ è¿”å›ä»»ä½•å†…å®¹çš„æƒ…å†µä¸‹æ‰æ’å…? â€œWHEREâ€? å­å¥ã€?
        è€Œä¸”ï¼Œè‹¥å­å¥çš„å¼€å¤´ä¸º â€œANDâ€? æˆ? â€œORâ€ï¼Œwhere å…ƒç´ ä¹Ÿä¼šå°†å®ƒä»¬å»é™¤ã??-->
    <select id="getBlogsIF" parameterType="map" resultType="Blog">
        select * from blog
        <where>

            <include refid="sql-title"></include>
        </where>
    </select>
    <!--åŠ¨æ?æŸ¥è¯¢ä¹‹Choose-->
    <!--<Choose>æ ‡ç­¾ç±»ä¼¼äºjavaä¸­çš„switchï¼?
    åªèƒ½æœ‰ä¸€ä¸ªç¬¦åˆçš„æ¡ä»¶è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæ²¡æœ‰é‚£å°±æ‰§è¡?<otherwise>æ ‡ç­¾é‡Œçš„SQL,æ³¨æ„è¯¥æ ‡ç­¾æ²¡æœ‰å…¶ä»–å±æ€?-->
    <select id="getBlogsChoose" parameterType="map" resultType="Blog">
        select * from blog
        <where>
            <choose>
                <when test="title != null">
                    and title = #{title}
                </when>
                <when test="author != null">
                    and author = #{author}
                </when>
                <otherwise>
                    and views  =#{views}
                </otherwise>
            </choose>
        </where>
    </select>

    <!--åŠ¨æ?æŸ¥è¯¢ä¹‹Set-->
    <!--set å…ƒç´ ä¼šåŠ¨æ€åœ°åœ¨è¡Œé¦–æ’å…? SET å…³é”®å­—ï¼Œ
        å¹¶ä¼šåˆ æ‰é¢å¤–çš„é?—å·ï¼ˆè¿™äº›é?—å·æ˜¯åœ¨ä½¿ç”¨æ¡ä»¶è¯­å¥ç»™åˆ—èµ‹å?¼æ—¶å¼•å…¥çš„ï¼‰ã€‚è¿™äº›é?—å·æ˜¯åœ¨ä½¿ç”¨æ¡ä»¶è¯­å¥ç»™åˆ—èµ‹å?¼æ—¶å¼•å…¥çš?-->
    <update id="updateBlog" parameterType="map" >
        update blog
        <set>
            <if test="title != null">
                 title = #{title},
            </if>
            <if test="author != null">
                 author = #{author},
            </if>
        </set>
        where id = #{id}
    </update>

    <!--åŠ¨æ?SQLä¹‹forEach-->
    <!--collectionå±æ?§è¡¨ç¤ºè¦å¾ªç¯çš„æ•°æ®ï¼Œopenè¡¨ç¤ºSQLå‰æ‹¼æ¥çš„ä¸œè¥¿ï¼Œcloseè¡¨ç¤ºSQLæ‹¼æ¥çš„ä¸œè¥¿ï¼Œseparatorè¡¨ç¤ºå¾ªç¯å±æ?§ä¹‹é—´æ’å…¥çš„ä¸œè¥¿-->
    <select id="getBlogForEach" parameterType="map" resultType="Blog">
        select * from blog
        <where>
            <foreach collection="ids" open="and (" close=")" item="id" separator="or">
                id = #{id}
            </foreach>
        </where>
    </select>
</mapper>